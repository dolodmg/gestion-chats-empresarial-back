<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Panel de Administración</title>
    <link rel="icon" type="image/x-icon" href="assets/favicon.ico">
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="css/admin.css">
    <link rel="stylesheet" href="css/password-eye.css">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
</head>
<body>
    <div class="app-header">
        <div class="user-info">
            <span id="user-name">Administrador</span>
        </div>
        <div class="actions">
            <button id="back-btn" class="btn secondary-btn">Volver</button>
            <button id="logout-btn" class="btn secondary-btn">Cerrar Sesión</button>
        </div>
    </div>

    <div class="admin-container">
        <div class="admin-sidebar">
            <ul class="admin-menu">
                <li class="active" data-tab="users">Usuarios</li>
                <li data-tab="stats">Estadísticas</li>
            </ul>
        </div>

        <div class="admin-content">
            <!-- Tab de Usuarios -->
            <div id="users-tab" class="admin-tab active">
                <div class="admin-header">
                    <h2>Gestión de Usuarios</h2>
                    <button id="add-user-btn" class="btn primary-btn">Agregar Usuario</button>
                </div>

                <div class="users-list-container">
                    <table id="users-table" class="admin-table">
                        <thead>
                            <tr>
                                <th>Nombre</th>
                                <th>Email</th>
                                <th>Rol</th>
                                <th>Client ID</th>
                                <th>Workflow ID</th>
                                <th>Token WhatsApp</th>
                                <th>Acciones</th>
                                
                            </tr>
                        </thead>
                        <tbody id="users-list">
                            <!-- Los usuarios se cargarán aquí dinámicamente -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Tab de Estadísticas -->
            <div id="stats-tab" class="admin-tab">
                <h2>Estadísticas</h2>
                <p>Panel de estadísticas en desarrollo...</p>
            </div>
        </div>
    </div>

    <!-- Modal para agregar/editar usuario -->
    <div id="user-modal" class="modal">
        <div class="modal-content">
            <span class="modal-close">&times;</span>
            <h2 id="modal-title">Agregar Usuario</h2>

            <form id="user-form">
                <input type="hidden" id="user-id">

                <div class="form-row">
                    <label for="user-name-input">Nombre</label>
                    <input type="text" id="user-name-input" required>
                </div>

                <div class="form-row">
                    <label for="user-email">Email</label>
                    <input type="email" id="user-email" required>
                </div>

                <div class="form-row">
                    <label for="user-password">Contraseña</label>
                    <div class="password-container">
                        <input type="password" id="user-password" required>
                        <button type="button" class="password-toggle" data-target="user-password">
                            <span class="eye-icon">
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512">
                                    <path fill="currentColor" d="M288 32c-80.8 0-145.5 36.8-192.6 80.6C48.6 156 17.3 208 2.5 243.7c-3.3 7.9-3.3 16.7 0 24.6C17.3 304 48.6 356 95.4 399.4C142.5 443.2 207.2 480 288 480s145.5-36.8 192.6-80.6c46.8-43.5 78.1-95.4 93-131.1c3.3-7.9 3.3-16.7 0-24.6c-14.9-35.7-46.2-87.7-93-131.1C433.5 68.8 368.8 32 288 32zM144 256a144 144 0 1 1 288 0 144 144 0 1 1 -288 0zm144-64c0 35.3-28.7 64-64 64c-7.1 0-13.9-1.2-20.3-3.3c-5.5-1.8-11.9 1.6-11.7 7.4c.3 6.9 1.3 13.8 3.2 20.7c13.7 51.2 66.4 81.6 117.6 67.9s81.6-66.4 67.9-117.6c-11.1-41.5-47.8-69.4-88.6-71.1c-5.8-.2-9.2 6.1-7.4 11.7c2.1 6.4 3.3 13.2 3.3 20.3z"/>
                                </svg>
                            </span>
                            <span class="eye-slash-icon" style="display: none;">
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512">
                                    <path fill="currentColor" d="M38.8 5.1C28.4-3.1 13.3-1.2 5.1 9.2S-1.2 34.7 9.2 42.9l592 464c10.4 8.2 25.5 6.3 33.7-4.1s6.3-25.5-4.1-33.7L525.6 386.7c39.6-40.6 72.5-89.1 90.9-142.3c5.8-16.8 5.8-35 0-51.8C582.5 78.5 479.8 0 320 0C236.2 0 164.5 40.1 112.2 100.3L38.8 5.1zM223.6 89.3C255 61.5 287.7 48 320 48c79.5 0 144 64.5 144 144c0 24.9-6.3 48.3-17.4 68.7L408 232.8c6.2-13 9.9-27.9 9.9-44.1c0-48.6-39.4-88-88-88l-7.8 .9 11.3-11.3z"/>
                                </svg>
                            </span>
                        </button>
                    </div>
                </div>

                <div class="form-row">
                    <label for="user-role">Rol</label>
                    <select id="user-role" required>
                        <option value="client">Cliente</option>
                        <option value="admin">Administrador</option>
                    </select>
                </div>

                <div id="client-id-container" class="form-row">
                    <label for="client-id">Client ID</label>
                    <input type="text" id="client-id" required>
                </div>

                <div id="workflow-id-container" class="form-row">
                    <label for="workflow-id">Workflow ID (n8n)</label>
                    <input type="text" id="workflow-id" placeholder="Ej: UPMeSeh2G9ibXE7S">
                    <small class="field-help">ID del workflow de n8n asociado a este cliente</small>
                </div>

                <div id="whatsapp-token-container" class="form-row">
                    <label for="whatsapp-token">Token de WhatsApp</label>
                    <div class="password-container">
                        <input type="password" id="whatsapp-token" placeholder="Token de acceso de WhatsApp">
                        <button type="button" class="password-toggle" data-target="whatsapp-token">
                            <span class="eye-icon">
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512">
                                    <path fill="currentColor" d="M288 32c-80.8 0-145.5 36.8-192.6 80.6C48.6 156 17.3 208 2.5 243.7c-3.3 7.9-3.3 16.7 0 24.6C17.3 304 48.6 356 95.4 399.4C142.5 443.2 207.2 480 288 480s145.5-36.8 192.6-80.6c46.8-43.5 78.1-95.4 93-131.1c3.3-7.9 3.3-16.7 0-24.6c-14.9-35.7-46.2-87.7-93-131.1C433.5 68.8 368.8 32 288 32zM144 256a144 144 0 1 1 288 0 144 144 0 1 1 -288 0zm144-64c0 35.3-28.7 64-64 64c-7.1 0-13.9-1.2-20.3-3.3c-5.5-1.8-11.9 1.6-11.7 7.4c.3 6.9 1.3 13.8 3.2 20.7c13.7 51.2 66.4 81.6 117.6 67.9s81.6-66.4 67.9-117.6c-11.1-41.5-47.8-69.4-88.6-71.1c-5.8-.2-9.2 6.1-7.4 11.7c2.1 6.4 3.3 13.2 3.3 20.3z"/>
                                </svg>
                            </span>
                            <span class="eye-slash-icon" style="display: none;">
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512">
                                    <path fill="currentColor" d="M38.8 5.1C28.4-3.1 13.3-1.2 5.1 9.2S-1.2 34.7 9.2 42.9l592 464c10.4 8.2 25.5 6.3 33.7-4.1s6.3-25.5-4.1-33.7L525.6 386.7c39.6-40.6 72.5-89.1 90.9-142.3c5.8-16.8 5.8-35 0-51.8C582.5 78.5 479.8 0 320 0C236.2 0 164.5 40.1 112.2 100.3L38.8 5.1zM223.6 89.3C255 61.5 287.7 48 320 48c79.5 0 144 64.5 144 144c0 24.9-6.3 48.3-17.4 68.7L408 232.8c6.2-13 9.9-27.9 9.9-44.1c0-48.6-39.4-88-88-88l-7.8 .9 11.3-11.3z"/>
                                </svg>
                            </span>
                        </button>
                    </div>
                    <small class="field-help">Token de acceso para la API de WhatsApp Business</small>
                </div>

                <div class="form-row">
                    <button type="submit" id="save-user-btn" class="btn primary-btn">Guardar</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal de confirmación para eliminar -->
    <div id="confirm-modal" class="modal">
        <div class="modal-content confirm-modal-content">
            <h3>¿Está seguro que desea eliminar este usuario?</h3>
            <p>Esta acción no se puede deshacer.</p>
            <div class="confirm-buttons">
                <button id="confirm-cancel" class="btn secondary-btn">Cancelar</button>
                <button id="confirm-delete" class="btn danger-btn">Eliminar</button>
            </div>
        </div>
    </div>

    <script src="js/admin.js"></script>
    <script src="js/ui-effects.js"></script>
    <script>
        // Inicializar la funcionalidad del ojito en la carga de la página
        document.addEventListener('DOMContentLoaded', function() {
            // Inicializar botones de mostrar/ocultar contraseña
            document.querySelectorAll('.password-toggle').forEach(button => {
                button.addEventListener('click', function() {
                    const targetId = this.getAttribute('data-target');
                    const passwordInput = document.getElementById(targetId);
                    const eyeIcon = this.querySelector('.eye-icon');
                    const eyeSlashIcon = this.querySelector('.eye-slash-icon');
                    
                    if (passwordInput.type === 'password') {
                        passwordInput.type = 'text';
                        eyeIcon.style.display = 'none';
                        eyeSlashIcon.style.display = 'block';
                    } else {
                        passwordInput.type = 'password';
                        eyeIcon.style.display = 'block';
                        eyeSlashIcon.style.display = 'none';
                    }
                });
            });
        });
    </script>
</body>
</html>